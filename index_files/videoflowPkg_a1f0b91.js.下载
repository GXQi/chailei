;/*!wiki-m-second:widget/polyfill/polyfill.js*/
define("wiki-m-second:widget/polyfill/polyfill",["require","exports","module","wiki-m-common:widget/util/promisePolyfill"],function(r,t,n){"use strict";var e=function(){return function(){}.bind||(Function.prototype.bind=function(r){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){var e=Array.prototype.slice.call(arguments),o=n.concat(e);return t.apply(r,o)}}),"function"!=typeof Object.assign&&(Object.assign=function(r){if(null===r)throw new TypeError("Cannot convert undefined or null to object");r=Object(r);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e])}return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(r,t){var n;if(null===this||void 0===this)throw new TypeError('"this" is null or not defined');var e=Object(this),o=e.length>>>0;if(0===o)return-1;var i=+t||0;if(1/0===Math.abs(i)&&(i=0),i>=o)return-1;for(n=Math.max(i>=0?i:o-Math.abs(i),0);o>n;){if(n in e&&e[n]===r)return n;n++}return-1}),Array.prototype.some||(Array.prototype.some=function(r){if(null===this||void 0===this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof r)throw new TypeError("first argument should be a function");for(var t=Object(this),n=t.length>>>0,e=arguments.length>=2?arguments[1]:void 0,o=0;n>o;o++)if(o in t&&r.call(e,t[o],o,t))return!0;return!1}),window.Promise||(window.Promise=r("wiki-m-common:widget/util/promisePolyfill")),"polyfill completed"}();n.exports=e});
;/*!wiki-m-second:widget/util/parseUri.js*/
define("wiki-m-second:widget/util/parseUri",["require","exports","module"],function(e,r,o){"use strict";function s(e){for(var r=s.options,o=r.parser[r.strictMode?"strict":"loose"].exec(e),t={},c=14;c--;)t[r.key[c]]=o[c]||"";return t[r.q.name]={},t[r.key[12]].replace(r.q.parser,function(e,o,s){o&&(t[r.q.name][o]=s)}),t}s.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:new RegExp(/^(?:([^:\/?#]+):)?/.source+/(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?/.source+/((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/.source),loose:new RegExp(/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?/.source+/(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)/.source+/(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.source)}},o.exports=s});
;/*!wiki-m-second:widget/util/util.js*/
define("wiki-m-second:widget/util/util",["require","exports","module","wiki-m-common:widget/lib/zepto/zepto","wiki-m-second:widget/util/parseUri"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("wiki-m-common:widget/lib/zepto/zepto"),r=e("wiki-m-second:widget/util/parseUri");t["default"]={getScreenWidth:function(){return document.body.clientWidth||window.screen.width||window.screen.availWidth},getScreenHeight:function(){return window.screen.height||window.screen.availHeight},getUaInfo:function(){var e=navigator.userAgent.toLowerCase(),t={isAndroid:/android/.test(e),isIos:/iphone/.test(e),isSamsung:/(.*android.+\bsm.+)/.test(e),isMiuiBrowser:/miuibrowser/.test(e),isOppo:/(.*android.+\boppo.+)/.test(e),isVivo:/(.*android.+\bvivo.+)/.test(e),is360Browser:/qihoobrowser/.test(e),isOppoBrowser:/oppobrowser/.test(e),isVivoBrowser:/vivobrowser/.test(e),isSamsungBrowser:/samsungbrowser/.test(e),isSafari:/iphone.*version\/[\d\.]+\s+mobile\/[\w\d]+\s+safari\/[\d\.]+$/.test(e),isSogouBrowser:/sogoumobilebrowser/.test(e),isBaiduBox:/baiduboxapp/.test(e),isBaiduBrowser:/baidubrowser/.test(e),isLiebaoBrowser:/liebaofast/.test(e),isWeChat:/micromessenger/.test(e),isUCBrowser:/ucbrowser/.test(e),isHuaweiBrowser:/\bbrowser\b/.test(e)&&/huawei/.test(e),isFirefox:/firefox/.test(e),isQQBrowser:/qqbrowser/.test(e)&&!/(micromessenger|_sq_)/.test(e),isChromeBrowser:/crios/.test(e)||/chrome\/[\d\.\s]+mobile safari\/[\d\.]+$/.test(e),isZuoyebang:/homework/.test(e),isSearchCraft:/searchcraft/.test(e)};return t},getQuery:function(e,t){t=t?r(t).query:window.location.search.slice(1);for(var o=t.split("&"),i={},s=0;s<o.length;s++){var n=o[s].split("=");i[n[0]]=n[1]}return i[e]||""},smoothScroll:function(e,t,o){if(!(0>o)){var r=t-i(window).scrollTop(),s=r/o*10;setTimeout(function(){isNaN(parseInt(s,10))||(window.scrollTo(0,i(window).scrollTop()+s),this.smoothScroll(e,t,o-10))}.bind(this),10)}},isPlainObject:function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},deepClone:function(e){var t=void 0;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e||"function"==typeof e||"undefined"==typeof e||null===e||e instanceof RegExp||e instanceof Date||e instanceof Event)t=e;else if("[object Array]"===Object.prototype.toString.call(e)){t=[];for(var o in e)t[o]=this.deepClone(e[o])}else if("object"==typeof e){t={};for(var o in e)t[o]=this.deepClone(e[o])}else t=e;return t},num2cn:function(e){var t=parseInt(e,10);return t>=1e4?((t-500)/1e4).toFixed(1).replace(".0","")+"万":t}},o.exports=t["default"]});
;/*!wiki-m-second:widget/util/canMutedPlay.js*/
define("wiki-m-second:widget/util/canMutedPlay",["require","exports","module","wiki-m-second:widget/util/util"],function(i,e,t){"use strict";function r(){var i=s.getUaInfo(),e=i.isIos&&(i.isSafari||i.isQQBrowser)||i.isChromeBrowser;return e}var s=i("wiki-m-second:widget/util/util");t.exports=r()});
;/*!wiki-m-second:widget/util/extendedJsmart.js*/
define("wiki-m-second:widget/util/extendedJsmart",["require","exports","module","wiki-m-common:widget/lib/jsmart/jsmart","wiki-m-second:widget/util/util"],function(e,t,r){"use strict";function i(e){return e=""+e,e.length<2&&(e="0"+e),e}var n=e("wiki-m-common:widget/lib/jsmart/jsmart"),o=e("wiki-m-second:widget/util/util");n.prototype.registerPlugin("modifier","number2cn",function(e){var t=parseInt(e,10);return isNaN(t)?"--":t>=1e4?((t-500)/1e4).toFixed(1).replace(".0","")+"万":e});var u=o.getScreenWidth();n.prototype.registerPlugin("modifier","ratioValue",function(e){var t=arguments.length<=1||void 0===arguments[1]?9/16:arguments[1];t=parseFloat(t);var r=parseFloat(e);return/\%$/.test(e)&&(r=r/100*u),Math.round(r*t)}),n.prototype.registerPlugin("modifier","rawurlencode",function(e){return encodeURIComponent(e)}),n.prototype.registerPlugin("modifier","timeformat",function(e){if(e=parseInt(e,10),!isNaN(e)){var t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60),n=e%60,o=[i(r),i(n)];return t>0&&o.unshift(i(t)),o.join(":")}}),r.exports=n});
;/*!wiki-m-second:widget/util/fetchData.js*/
define("wiki-m-second:widget/util/fetchData",["require","exports","module","wiki-m-second:widget/polyfill/polyfill","wiki-m-common:widget/lib/zepto/zepto"],function(e,t,i){"use strict";function r(e){var t={type:"GET",dataType:"json",maxRetryTimes:0};return e=Object.assign(t,e),e.maxRetryTimes="number"==typeof e.maxRetryTimes?e.maxRetryTimes:0,e.type=-1!==n.inArray(e.type.toUpperCase(),["GET","POST"])?e.type:"GET",e.data=n.isPlainObject(e.data)?e.data:{},e}function o(e){function t(r,o){e.success=function(n){0===parseInt(n.errno,10)?r(n):i<e.maxRetryTimes?(i++,t(r,o)):o(n)},e.error=function(n){i<e.maxRetryTimes?(i++,t(r,o)):o(n)},n.ajax(e)}if(e=r(e),!e.url)throw new Error("[FetchData Error] url is necessary");var i=0,o=new Promise(t);return o.done=o.then,o.fail=o["catch"],o}e("wiki-m-second:widget/polyfill/polyfill");var n=e("wiki-m-common:widget/lib/zepto/zepto");i.exports=o});
;/*!wiki-m-second:widget/util/getPageFrom.js*/
define("wiki-m-second:widget/util/getPageFrom",["require","exports","module","wiki-m-common:widget/util/url"],function(e,r,t){"use strict";function i(){var e=arguments.length<=0||void 0===arguments[0]?window.location.href:arguments[0],r="lemma";if(/(bk_share|from=timeline|from=singlemessage|from=groupmessage)/.test(e))r="share";else{var t=m.getQuery("from"),i=m.getQuery("type"),o=m.getQuery("fr");t?r=t:o&&(r=o),i&&(r=r+"__"+i)}return r}var m=e("wiki-m-common:widget/util/url");t.exports=i});
;/*!wiki-m-second:widget/util/getVodFile.js*/
define("wiki-m-second:widget/util/getVodFile",["require","exports","module"],function(e,t,d){"use strict";function p(e){var t=arguments.length<=1||void 0===arguments[1]?{isHttps:!0,mediaType:"M3U8"}:arguments[1],d="",p=t.isHttps?"https:":"http:",r=t.mediaType||"M3U8";switch(r.toUpperCase()){case"M3U8":d=p+"//gcjgdrdrzymhp9e2xpz.exp.bcevod.com/"+e+"/"+e+".m3u8";break;case"MP4":default:d=p+"//gcjgdrdrzymhp9e2xpz.exp.bcevod.com/"+e+"/mp4/"+e+".mp4"}return d}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=p,d.exports=t["default"]});
;/*!wiki-m-second:widget/util/guid.js*/
define("wiki-m-second:widget/util/guid",["require","exports","module"],function(x,e,t){"use strict";function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(x){var e=16*Math.random()|0,t="x"===x?e:3&e|8;return t.toString(16)})}t.exports=r});
;/*!wiki-m-second:widget/util/inSightDetector.js*/
define("wiki-m-second:widget/util/inSightDetector",["require","exports","module"],function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){return!!t&&"object"==typeof t&&1===t.nodeType}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e){n(this,t),this.config=this._normalize(e),this._store=[],this._ticking=!1,this._lastTimestamp=Date.now(),this._viewportHeight=window.innerHeight,this._throttledDetect=this._throttledDetect.bind(this)}return o(t,[{key:"_normalize",value:function(t){return"object"!=typeof t&&(t={}),{interval:t.interval||0,offset:t.offset||0}}},{key:"_throttledDetect",value:function(t){var e=this,i=Date.now(),n=i-this._lastTimestamp;this._lastTimestamp=i,!this._ticking&&this._store.length&&n>=this.config.interval&&window.requestAnimationFrame(function(){e._detect(t),e._ticking=!1}),this._ticking=!0}},{key:"_detect",value:function(t){var e=this,i=this._store;r(t)&&(i=this._store.filter(function(e){return e.el.isSameNode(t)})),i.forEach(function(t){e._isInSight(t.el)&&t.callback()})}},{key:"_isInSight",value:function(t){var e=t.getBoundingClientRect(),i=e.top,n=e.bottom,r=e.height,o=this._translateOffset(this.config.offset,r),s=i>0&&i+o<this._viewportHeight,a=n-o>0&&n<this._viewportHeight,l=s||a;return l}},{key:"_translateOffset",value:function(t,e){var i=/^\d+%$/;if(i.test(t)){var n=parseInt(t,10)/100;t=Math.round(e*n)}else t=parseInt(t,10);return t}},{key:"addListener",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];r(t)&&(this._store.length||window.addEventListener("scroll",this._throttledDetect),this._store.push({el:t,callback:e}),this._throttledDetect(t))}},{key:"removeListener",value:function(t){r(t)&&(this._store=this._store.filter(function(e){return!e.el.isSameNode(t)}),this._store.length||window.removeEventListener("scroll",this._throttledDetect))}},{key:"removeAllListeners",value:function(){this._store=[],window.removeEventListener("scroll",this._throttledDetect)}}]),t}();i.exports=s});
;/*!wiki-m-second:widget/util/throttle.js*/
define("wiki-m-second:widget/util/throttle",["require","exports","module"],function(e,t,i){"use strict";function a(e,t){if(!a.lastTimestamp)return void(a.lastTimestamp=Date.now());var i=Date.now();i-a.lastTimestamp>t&&(e(),a.lastTimestamp=i)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a,i.exports=t["default"]});
;/*!wiki-m-second:widget/logMap/logMap.js*/
define("wiki-m-second:widget/logMap/logMap",["require","exports","module","wiki-m-second:widget/util/getPageFrom"],function(e,i,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=e("wiki-m-second:widget/util/getPageFrom"),c={play:"22400403",firstPlay:"22400407",complete:"22400404",pause:"22400405",close:"22400406",playedTime:"22400408",overlayClick:"22400409",durationTime:"22400303",videoContainerClick:"22400104",pgcVideoContainerClick:"22400502",likeClick:"22400217",feedbackGuideIconClick:"22400215",ellipsisIconClick:"22400507",feedbackClick:"22400216",lemmaClick:"22400113",videoShareClick:"22400114",userPv:"22400506",pgcVideoPv:"22400505",topicPv:"22400508",topicClick:"22400509",homepageClick:"22400510",pv:"22400103",videoSourceClick:"22400504",goBackBtnClick:"22400105",joinUsClick:"22400107",leavePage:"22400302",videoPlayError:"20099902",hlsDetector:"20099903",videoPlayRetry:"20099904",playViaRetry:"20099905",invalidTime:"22400900",from:o()};i["default"]=c,l.exports=i["default"]});
;/*!wiki-m-second:widget/videoFlow/VideoFlow.js*/
define("wiki-m-second:widget/videoFlow/VideoFlow",["require","exports","module","wiki-m-common:widget/lib/zepto/zepto","wiki-m-common:widget/util/nslog","wiki-m-common:widget/util/animation","wiki-m-second:widget/polyfill/polyfill","wiki-m-second:widget/util/util","wiki-m-common:widget/util/url","wiki-m-second:widget/logMap/logMap","wiki-m-common:widget/util/cookie","wiki-m-common:widget/component/larkplayer/js/larkplayer","wiki-m-second:widget/util/guid","wiki-m-second:widget/util/throttle","wiki-m-common:widget/component/swan/swanUtil"],function(e,i,t){"use strict";function o(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function a(){return document.body.clientWidth}function n(e){var i=0;switch(e){case"同词条":i=1;break;case"相关推荐":i=2;break;case"热门推荐":i=3;break;case"相关人物":i=4;break;default:i=0}return i}function r(e){return"string"==typeof e?e.replace(/^http:/,"https:"):e}Object.defineProperty(i,"__esModule",{value:!0});var l=function(){function e(e,i){for(var t=0;t<i.length;t++){var o=i[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(i,t,o){return t&&e(i.prototype,t),o&&e(i,o),i}}(),s=e("wiki-m-common:widget/lib/zepto/zepto"),d=e("wiki-m-common:widget/util/nslog"),u=e("wiki-m-common:widget/util/animation"),c=(e("wiki-m-second:widget/polyfill/polyfill"),e("wiki-m-second:widget/util/util")),p=e("wiki-m-common:widget/util/url"),m=e("wiki-m-second:widget/logMap/logMap"),g=(e("wiki-m-common:widget/util/cookie"),e("wiki-m-common:widget/component/larkplayer/js/larkplayer")),h=e("wiki-m-second:widget/util/guid"),f=e("wiki-m-second:widget/util/throttle"),y=e("wiki-m-common:widget/component/swan/swanUtil"),w={defaultString:"-",defaultNumber:0,screenWidth:c.getScreenWidth(),screenHeight:c.getScreenHeight(),lastClientWidth:a(),useragentInfo:c.getUaInfo(),isHttps:"https:"===window.location.protocol,originalUrl:window.location.href,originalPath:window.location.href.substring(window.location.origin.length),isSF:window._SF_||window.page&&window.page.inSf};w.baseUrl="",w.isSF&&(w.baseUrl=window.page&&window.page.baseUrl?window.page.baseUrl:"//wapbaike.baidu.com"),w.isUcBrowserBelow11=/ucbrowser\/10/.test(window.navigator.userAgent.toLowerCase());var v=function(){function e(){o(this,e)}return l(e,[{key:"constructorInit",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.beforeAutoPlay=e.beforeAutoPlay,this.autoPlayIndex=e.autoPlayIndex||0,this.maxRetries=e.maxRetries||1,this.isContinueToPlayNext=!0,this.handleScroll=this.handleScroll.bind(this),this.canPlayOnScroll=!1,this.isUserTouch=!1,this.player=null,this.playerTopPosition=-9999,this.retries=0,this.curIndex=void 0,this.playingVideoClassName="playingVideo",this.logMap=s.extend(m,e.logMap),this.useragentInfo=w.useragentInfo,this.topNavBarHeight=s(".top-place").height()||44,this.isHitFlow=e.isHitFlow?1:0,y.inSmartprogram&&(this.topNavBarHeight=0),s("#J-baike-player").length||this.appendPlayerHtml(),this.$playerContainer=s(".J-baike-player-container"),s(window).on("scroll",this.handleScroll),this.supportHls=this.isSupportHls(),d.q2(m.hlsDetector,["isSupport="+(this.supportHls?1:0)])}},{key:"init",value:function(){this.initPlayer(),this.bindEvents()}},{key:"isSupportHls",value:function i(){var i=!1,e=document.createElement("video"),t=e.canPlayType('application/x-mpegURL;codecs="avc1.640028,mp4a.40.2"'),o=e.canPlayType('application/vnd.apple.mpegurl;codecs="avc1.640028,mp4a.40.2"'),a=new RegExp("probably");return(a.test(t)||a.test(o))&&(i=!0),e=null,i}},{key:"getVodFile",value:function(e){return"https://gcjgdrdrzymhp9e2xpz.exp.bcevod.com/"+e+"/"+e+".m3u8"}},{key:"setCurIndex",value:function(e){var i=parseInt(e,10),t=isNaN(i)?"error_index_"+e:i;this.curIndex=t}},{key:"getCurIndex",value:function(){return this.curIndex}},{key:"disableFullscreen",value:function(){this.$playerContainer.addClass("cus-disable-fullscreen")}},{key:"appendPlayerHtml",value:function(){var e='\n            <div class="baike-player-container J-baike-player-container">\n                <video id="J-baike-player" webkit-playsinline="true" class="baike-player"></video>\n            </div>',i=s(w.isSF?"#sfr-app > .rt-view > .rt-body":"body");i&&!s("#J-baike-player").length&&i.append(e)}},{key:"initPlayer",value:function(){var e=this;this.playerHeight=Math.round(9*w.screenWidth/16),this.player=g("J-baike-player",{width:w.screenWidth,height:Math.round(9*w.screenWidth/16)}),this.player.on("ready",function(){w.useragentInfo.isZuoyebang&&w.useragentInfo.isAndroid&&e.disableFullscreen()});var i=w.defaultString,t=w.defaultString,o=w.defaultNumber,a=w.defaultNumber,r=w.defaultNumber,l=void 0,u=w.defaultString,c=w.defaultNumber,m=w.defaultNumber;this.player.on("play",function(){r=e.getCurIndex(),m=p.getQuery("lemmaId");var l=s(".J-video").eq(r).data()||{};i=l.mediaid||w.defaultString,a=l.lemmaid||m||w.defaultNumber,o=l.secondid||w.defaultNumber,t=l.secondkind||"1",u=l.source,c=n(l.source),d.q2(e.logMap.play,["secondId="+o,"index="+r,"source="+c,"relation="+u,"firstLemmaId="+m,"lemmaId="+a,"muted="+e.player.muted(),"userAgent="+window.navigator.userAgent,"from="+e.logMap.from,"isHitFlow="+e.isHitFlow]);var g=w.baseUrl+"/wikisecond/viewnum?type=set&secondId="+(o+"&mediaId="+i+"&secondKind="+t+"&from="+e.logMap.from),h=/\/topic/.test(window.location.href);h&&(g+="&fr=topic"),s.get(g),e.retries>0&&d.q2(e.logMap.playViaRetry,["mediaId="+i,"retries="+e.retries])}),this.player.on("firstplay",function(){var i=Date.now()-window.loadStartTimestamp;d.q2(e.logMap.firstPlay,["cusLoadTime="+i,"secondId="+o,"index="+r,"source="+c,"relation="+u,"firstLemmaId="+m,"lemmaId="+a,"muted="+e.player.muted(),"from="+e.logMap.from,"isHitFlow="+e.isHitFlow]),l=h(),e.canPlayOnScroll=!0});var y=void 0,v=void 0;this.player.on("timeupdate",function(){f(function(){if(l){var i=e.player.duration(),t=e.player.currentTime(),n=!t||0>t||!i||1>i||1/0===i;if(n&&v!==o)return v=o,void d.q2(e.logMap.invalidTime,["index="+r,"secondId="+o,"duration="+i,"currentTime="+t,"pageUrl="+window.location.href]);var s=10*Math.floor(t/i*10);if(s!==y){y=s;var p=e.getPlayedTime(),g=Math.floor(p/i*100);d.q2(e.logMap.playedTime,["currentTime="+t,"currentTimePercent="+s,"playedTime="+p,"playedTimePercent="+g,"duration="+i,"guid="+l,"secondId="+o,"index="+r,"source="+c,"relation="+u,"firstLemmaId="+m,"lemmaId="+a,"muted="+e.player.muted(),"from="+e.logMap.from,"isHitFlow="+e.isHitFlow])}}},2e3)}),this.player.on("pause",function(){var i=e.player.currentTime(),t=e.player.duration();d.q2(e.logMap.pause,["index="+r,"currentTime="+i,"duration="+t,"secondId="+o,"from="+e.logMap.from])}),this.player.on("ended",function(){d.q2(e.logMap.complete,["index="+r,"secondId="+o,"source="+c,"relation="+u,"firstLemmaId="+m,"lemmaId="+a,"muted="+e.player.muted(),"from="+e.logMap.from,"isHitFlow="+e.isHitFlow]);var i=e.player.currentTime(),t=e.player.duration(),n=100,p=e.getPlayedTime(),g=Math.floor(p/t*100);d.q2(e.logMap.playedTime,["currentTime="+i,"currentTimePercent="+n,"playedTime="+p,"playedTimePercent="+g,"duration="+t,"guid="+l,"secondId="+o,"index="+r,"source="+c,"relation="+u,"firstLemmaId="+m,"lemmaId="+a,"muted="+e.player.muted(),"from="+e.logMap.from,"isHitFlow="+e.isHitFlow]);var h=e.getCurIndex()+1,f=s(".J-video").eq(h);if(!w.isUcBrowserBelow11&&!w.isHuaweiBrowser&&(e.stopVideo(),f.hasClass("J-video"))){var y=f.offset().top-e.topNavBarHeight-10;e.scrollTo(y,function(){!f.hasClass("pgcVideo")&&e.isContinueToPlayNext&&e.playVideo(h)})}}),this.player.on("error",function(i,t){var o=e.getCurIndex(),a=e.player.src();if(void 0!==o){var n=s(".J-video").eq(o).data("mediaid"),r={mediaId:n,message:t.message,code:t.code,url:window.location.href,playUrl:a,userAgent:window.navigator.userAgent};s.get(w.baseUrl+"/api/wikisecond/seterror",r),d.q2(e.logMap.videoPlayError,["mediaId="+n,"url="+window.location.href,"playUrl="+a,"message="+r.message,"code="+r.code,"userAgent="+window.navigator.userAgent,"from="+e.logMap.from])}})}},{key:"getPlayedTime",value:function(){var e=this.player.played(),i=0;if(e&&e.length)for(var t=0;t<e.length;t++)i+=e.end(t)-e.start(t);return i}},{key:"playVideo",value:function(e){this.retries=0,this.setCurIndex(e);var i=s(".J-video").eq(e);if(i.length>0&&!i.hasClass("pgcVideo")){var t=r(i.data("playurl")),o=r(i.data("playmp4url")),a=o||t;this.playerTopPosition=i.offset().top,this._setPlayingSign(i),this._play(a)}}},{key:"stopVideo",value:function(){if(s("."+this.playingVideoClassName).length>0&&this.player){var e=this.player.currentTime(),i=this.player.duration();d.q2(this.logMap.close,["currentTime="+e,"duration="+i])}this._removePlayingSign(s("."+this.playingVideoClassName)),this._hackInStop()}},{key:"_putPlayerOnTargetPosition",value:function(e){"static"===this.$playerContainer.css("position")&&this.$playerContainer.css("position","absolute"),this.$playerContainer.offset({top:e})}},{key:"_play",value:function(e){window.loadStartTimestamp=Date.now(),this.player.src(e),this._hackInPlay(),this._putPlayerOnTargetPosition(this.playerTopPosition),this.player.play()}},{key:"_hackInPlay",value:function(){var e="cus-player-z-index-lower-than-cover";w.useragentInfo.isIos&&w.useragentInfo.isUCBrowser&&(this.$playerContainer.hasClass(e)||this.$playerContainer.addClass(e))}},{key:"_hackInStop",value:function(){this.$playerContainer.css("position","absolute"),this.$playerContainer.offset({top:-9999}),this.player&&(this.player.pause(),this.player.exitFullscreen(),this.player.reset())}},{key:"_setPlayingSign",value:function(e){s.zepto.isZ(e)&&e.length>0&&(e.addClass(this.playingVideoClassName),this.playingElemOffset=e.offset())}},{key:"_removePlayingSign",value:function(e){s.zepto.isZ(e)&&e.length>0&&(e.removeClass(this.playingVideoClassName),this.playingElemOffset={})}},{key:"bindEvents",value:function(){var e=this,i=this;s(window).on("resize",function(){var i=a();if(i!==w.lastClientWidth){w.lastClientWidth=i;var t=s(".J-video").eq(e.getCurIndex());t.hasClass(e.playingVideoClassName)&&e._putPlayerOnTargetPosition(t.offset().top)}}),s(".video-list").on("touchstart",function(){e.isUserTouch=!0}),s(".video-list").on("touchmove",function(){e.isUserTouch=!0}),s(".video-list").on("touchend",function(){setTimeout(function(){e.isUserTouch=!1},200)}),s(".video-list").on("click",".video-container",function(){var e=s(this).parents(".video-item"),t=s(".J-video").index(e);if(d.q2(i.logMap.videoContainerClick,["index="+t,"secondId="+e.data("secondid"),"from="+i.logMap.from]),i.stopVideo(),s(".J-netTip-cnt").length>0&&s(".J-netTip-cnt").remove(),e.hasClass("pgcVideo")){var o=p.getQuery("lemmaId"),a=e.data()||{},r=a.mediaid,l=a.secondid,u=a.secondkind,c=a.source,m=c;c=n(c),d.q2(i.logMap.pgcVideoContainerClick,["index="+t,"source="+c,"relation="+m,"firstLemmaId="+o,"secondId="+l,"from="+i.logMap.from]),s.get("/wikisecond/viewnum?type=set&secondId="+l+"&mediaId="+r+"&secondKind="+u),setTimeout(function(){y.inSmartprogram?y.navigateTo(e.data("url")):window.location.href=e.data("url")},200)}else i.playVideo(t)}),s(".video-list").on("click",".J-video-item__overlay",function(){i.player.pause();var e=s(this).parents(".J-video"),t=s(".J-video").index(e),o=e.data("secondid"),a=e.data("lemmaid");d.q2(i.logMap.overlayClick,["index="+t,"secondId="+o,"lemmaId="+a,"from="+i.logMap.from]);var n=e.offset().top-i.topNavBarHeight-10;i.scrollTo(n,function(){i.stopVideo(),e.hasClass("pgcVideo")||i.playVideo(t)})}),this.useragentInfo.isWeChat&&s(document).on("WeixinJSBridgeReady",function(){window.WeixinJSBridge.invoke("getNetworkType",{},function(i){/wifi/.test(i.err_msg)&&("function"==typeof e.beforeAutoPlay&&e.beforeAutoPlay(),e.playVideo(e.autoPlayIndex))})})}},{key:"scrollTo",value:function(e,i){{var t=s(window),o=t.scrollTop(),a=e-o;u({duration:300,delay:300,easing:"easeOutQuad",onStep:function(e){t.scrollTop(o+a*e)},onComplete:function(){"function"==typeof i&&i()}})}}},{key:"handleScroll",value:function(){if(!this.player.isFullscreen()){var e=this.caculateFocusVideo();this.getCurIndex()!==e&&this.stopVideo(),this.highlightVideo(e),this.autoplayOnScroll(e)}}},{key:"highlightVideo",value:function(e){var i=s(".J-video"),t="videoflow-highlight";s("."+t).removeClass(t),i.eq(e).addClass(t)}},{key:"autoplayOnScroll",value:function(e){var i=this;clearTimeout(this.autoplayTimeoutHandler),this.autoplayTimeoutHandler=setTimeout(function(){var t=!!s("."+i.playingVideoClassName).length,o=i.getCurIndex();o===e&&t||!i.isContinueToPlayNext||!i.canPlayOnScroll||w.useragentInfo.isUCBrowser||w.useragentInfo.isOppo||i.playVideo(e)},100)}},{key:"caculateFocusVideo",value:function(){for(var e=s(".J-video"),i=-1,t=0;t<e.length;t++){var o=e[t],a=o.getBoundingClientRect(),n=.2;if(a.top>this.topNavBarHeight-this.playerHeight*n){i=t;break}}return i}},{key:"closeVideoOutsideView",value:function(){if("boolean"!=typeof this.isUserTouch&&(this.isUserTouch=!0),s("."+this.playingVideoClassName).length>0&&this.isUserTouch){var e=s(window).scrollTop(),i=1/3,t=e>this.playingElemOffset.top-this.topNavBarHeight+this.playingElemOffset.height*i,o=e+w.screenHeight<this.playingElemOffset.top+this.topNavBarHeight+this.playingElemOffset.height*(1-i);(t||o)&&this.stopVideo()}}}]),e}();i["default"]=v,t.exports=i["default"]});
;/*!wiki-m-second:widget/component/praise/praise.js*/
define("wiki-m-second:widget/component/praise/praise",["require","exports","module","wiki-m-common:widget/lib/zepto/zepto","wiki-m-common:widget/util/cookie","wiki-m-second:widget/util/util"],function(e,i,n){"use strict";function t(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function o(e,i,n,t){r.ajax({type:"GET",url:page.baseUrl+"/api/wikisecond/goodnum?secondId="+e+"&type="+i,cache:!1,data:self.queryParam,success:function(e){n(e)},error:function(e){t(e)}})}function a(e){for(var i=0;i<r('[data-praise="praise"]').length;i++)new f(r('[data-praise="praise"]')[i],e)}var s=function(){function e(e,i){for(var n=0;n<i.length;n++){var t=i[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(i,n,t){return n&&e(i.prototype,n),t&&e(i,t),i}}(),r=e("wiki-m-common:widget/lib/zepto/zepto"),c=e("wiki-m-common:widget/util/cookie"),d=e("wiki-m-second:widget/util/util"),u="ani-praised",l="active",m=/^[\d\.]+$/,h=500,p=8760,f=function(){function e(i){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];t(this,e),this.options=n,this.$container=r(i),this.$numContainer=this.$container.find("[data-praise-num]"),this.isCompletePraise=!0,this.secondId=this.$container.data("secondId"),this.handleTap=this.handleTap.bind(this);var o=this.$numContainer.text();m.test(o)&&this.$numContainer.text(d.num2cn(o));var a=-1!==c.read("hasPraised").indexOf(this.secondId+",");a&&this.$container.addClass(l),this.$container.off("tap",this.handleTap),this.$container.on("tap",this.handleTap)}return s(e,[{key:"handleTap",value:function(){var e=this;this.isCompletePraise&&(this.isCompletePraise=!1,this.$container.hasClass(l)?o(this.secondId,"del",function(i){e.$container.removeClass(l+" "+u),e.isCompletePraise=!0,e.$numContainer.html(d.num2cn(i.goodNum));var n=c.read("hasPraised").replace(e.secondId+",","");c.write("hasPraised",n,p,window.location.host)},function(i){e.isCompletePraise=!0,console.log(i)}):o(this.secondId,"set",function(i){e.$container.addClass(l),e.options.showAnimation&&(e.$container.addClass(u),setTimeout(function(){e.$container.removeClass(u)},h)),e.isCompletePraise=!0,e.$numContainer.html(d.num2cn(i.goodNum));var n=c.read("hasPraised")+e.secondId+",";c.write("hasPraised",n,p,window.location.host)},function(i){e.isCompletePraise=!0,console.log(i)}))}}]),e}();n.exports=a});
;/*!wiki-m-second:widget/config/config.js*/
define("wiki-m-second:widget/config/config",["require","exports","module"],function(e,i,t){"use strict";t.exports={ak:"ccb343d827ff4845b5e31d4524e027a9",defaultFile:"//baikebcs.bdimg.com/others/mda-anemptyfile20170518.m3u8",feedbackExampleTextList:["无法播放","视频卡顿","没有画面","内容有误","读音有误","为秒懂点赞"]}});
;/*!wiki-m-second:widget/videoFlowIn2nd/VideoFlowIn2nd.js*/
define("wiki-m-second:widget/videoFlowIn2nd/VideoFlowIn2nd",["require","exports","module","wiki-m-second:widget/videoFlow/VideoFlow","wiki-m-common:widget/lib/zepto/zepto","wiki-m-common:widget/util/nslog","wiki-m-common:widget/util/cookie","wiki-m-common:widget/component/share/floatShare","wiki-m-common:widget/util/animation","wiki-m-second:widget/logMap/logMap","wiki-m-second:widget/component/praise/praise","wiki-m-common:widget/component/feedback/feedback","wiki-m-second:widget/config/config","wiki-m-common:widget/component/ufoFeedback/ufoFeedback","wiki-m-common:widget/component/swan/swanUtil"],function(e,o,t){"use strict";function i(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function n(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function e(e,o){for(var t=0;t<o.length;t++){var i=o[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(o,t,i){return t&&e(o.prototype,t),i&&e(o,i),o}}(),d=function(e,o,t){for(var i=!0;i;){var n=e,a=o,d=t;i=!1,null===n&&(n=Function.prototype);var r=Object.getOwnPropertyDescriptor(n,a);if(void 0!==r){if("value"in r)return r.value;var c=r.get;return void 0===c?void 0:c.call(d)}var m=Object.getPrototypeOf(n);if(null===m)return void 0;e=m,o=a,t=d,i=!0,r=m=void 0}},r=e("wiki-m-second:widget/videoFlow/VideoFlow"),c=e("wiki-m-common:widget/lib/zepto/zepto"),m=e("wiki-m-common:widget/util/nslog"),s=(e("wiki-m-common:widget/util/cookie"),e("wiki-m-common:widget/component/share/floatShare")),l=(e("wiki-m-common:widget/util/animation"),e("wiki-m-second:widget/logMap/logMap")),f=e("wiki-m-second:widget/component/praise/praise"),p=(e("wiki-m-common:widget/component/feedback/feedback"),e("wiki-m-second:widget/config/config"),e("wiki-m-common:widget/component/ufoFeedback/ufoFeedback")),u=e("wiki-m-common:widget/component/swan/swanUtil"),w={toLemmaUrl:"",curIndex:0},v=function(e){function o(){i(this,o),d(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}return n(o,e),a(o,[{key:"constructorInit",value:function(e){d(Object.getPrototypeOf(o.prototype),"constructorInit",this).call(this,e)}},{key:"goLemma",value:function(){c(".to-lemma").on("tap",function(){var e=c(this).parents(".J-video"),o=e.data("secondid"),t=c(".J-video").index(e);m.q2(l.lemmaClick,["index="+t,"secondId="+o,"from="+l.from]),u.inSmartprogram?u.navigateTo(w.toLemmaUrl):window.location.href=w.toLemmaUrl}).on("touchend",function(e){e.preventDefault()})}},{key:"feedback",value:function(){c(".J-feedback").on("tap",function(){var e=(c(this),c(".J-video").eq(w.curIndex)),o=e.data("lemmaid"),t=e.data("mediaid"),i=e.data("secondid"),n=e.data("lemmatitle");m.q2(l.feedbackClick,["lemmaId="+o,"secondId="+i,"from="+l.from]);var a={extend_title:n,media_id:t,second_id:i,channelId:33175},d=p.getUrl(a);u.inSmartprogram?u.navigateTo(d):window.location.href=d}).on("touchend",function(e){e.preventDefault()})}},{key:"like",value:function(){c(".J-praise").on("tap",function(){var e=c(this),o=e.parents(".J-video");if(!e.hasClass("active")){var t=c(".J-video").index(o),i=o.data("secondid");m.q2(l.likeClick,["index="+t,"secondId="+i,"from="+l.from])}})}},{key:"topic",value:function(){var e=c(".J-topic-link"),o=e.length,t=this;if(o){for(var i=[],n=0;o>n;n++){var a=e.eq(n).data("topicid");a&&i.push(a)}m.q2(l.topicPv,["topicCount="+o,"topicIds="+i.join(","),"from="+l.from]),e.on("tap",function(){var e=c(this),o=e.parents(".J-video"),i=c(".J-video").index(o),n=o.data("secondid"),a=e.data("topicid");m.q2(l.topicClick,["index="+i,"secondId="+n,"topicId="+a,"from="+l.from]),u.inSmartprogram&&t.stopVideo&&t.stopVideo()})}}},{key:"share",value:function(){var e=this;c(".J-share").on("tap",function(){e.stopVideo&&e.stopVideo();var o=c(this),t=o.parents(".J-video"),i=t.data("secondid"),n=o.data("lemmaid");s.uploadParamAndShare({title:o.data("mediatitle")+"-秒懂百科",desc:"秒懂百科：短视频涨知识，世界如此简单。",url:"https://baike.baidu.com/wikisecond/videoflow?lemmaId="+n+("&secondId="+i),pic:o.data("pic")});var a=c(".J-video").index(t);m.q2(l.videoShareClick,["index="+a,"secondId="+i,"from="+l.from]),c.get("/api/wikisecond/sharenum?secondId="+i)})}},{key:"more",value:function(){var e=c(".J-more"),o=c(".J-more-bubble");c("body").on("touchstart",function(e){/(J-more)|(J-layout-icons_new-more-horizontal)/.test(e.target.className)||o.hide()}),e.on("tap",function(){o.fadeIn(150);var e=c(this),t=e.offset(),i=o.offset(),n=t.top-c(".video-list").offset().top-Math.abs(t.height-i.height)/2;n-=1,o.css("top",n);var a=e.parents(".J-video"),d=a.data("secondid"),r=e.data("sharelemmatitle"),s=e.data("sharelemmaid");w.curIndex=c(".J-video").index(a),w.toLemmaUrl=page.baseUrl+"/item/"+r+"/"+s,m.q2(l.ellipsisIconClick,["lemmaId="+s,"secondId="+d,"from="+l.from])}).on("touchend",function(e){e.preventDefault()})}},{key:"bindEvents",value:function(){d(Object.getPrototypeOf(o.prototype),"bindEvents",this).call(this),f({showAnimation:!0}),this.share(),this.goLemma(),this.feedback(),this.like(),this.more(),this.topic();var e=this;c(".J-user-info .J-user-link").on("tap",function(){var o=c(this),t=o.parents(".J-video"),i=t.data("secondid"),n=o.data("uk");m.q2(l.videoSourceClick,["secondId="+i,"from="+l.from,"uk="+n]),u.inSmartprogram?(e.stopVideo&&e.stopVideo(),u.navigateTo(c(this).data("href"))):window.location.href=c(this).data("href")}).on("touchend",function(e){e.preventDefault()}),c(".J-top-homepage").on("tap",function(){m.q2(l.homepageClick)})}}]),o}(r);o["default"]=v,t.exports=o["default"]});